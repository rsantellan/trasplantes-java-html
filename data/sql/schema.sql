CREATE TABLE cmv (id INT AUTO_INCREMENT, trasplante_id INT NOT NULL, fecha DATE NOT NULL, cmv_diagnostico_id INT NOT NULL, tipo TINYINT NOT NULL, cmv_droga_id INT NOT NULL, dias_tratamiento SMALLINT DEFAULT 0 NOT NULL, efecto_secundario VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX trasplante_id_idx (trasplante_id), INDEX cmv_diagnostico_id_idx (cmv_diagnostico_id), INDEX cmv_droga_id_idx (cmv_droga_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE cmv_uso_enfermedades (cmv_id INT, cmv_emfermedades_id INT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(cmv_id, cmv_emfermedades_id)) ENGINE = INNODB;
CREATE TABLE cmvdiagnostico (id INT AUTO_INCREMENT, nombre VARCHAR(50) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE cmvdrogas (id INT AUTO_INCREMENT, nombre VARCHAR(50) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE cmvemfermedades (id INT AUTO_INCREMENT, nombre VARCHAR(50) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE nefropatia (id INT AUTO_INCREMENT, nombre VARCHAR(255) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE paciente_causa_muerte (id INT AUTO_INCREMENT, nombre VARCHAR(255) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE paciente_muerte (paciente_id INT, causa_muerte_id INT NOT NULL, fecha_muerte DATE NOT NULL, transplante_funcionando TINYINT DEFAULT 0, INDEX causa_muerte_id_idx (causa_muerte_id), PRIMARY KEY(paciente_id)) ENGINE = INNODB;
CREATE TABLE paciente_pre_trasplante (id INT AUTO_INCREMENT, paciente_id INT NOT NULL, the INT NOT NULL, fecha_ingreso_lista DATE NOT NULL, fecha_egreso DATE, modalidad_d VARCHAR(11) NOT NULL, diabetes VARCHAR(8) NOT NULL, imc VARCHAR(14) NOT NULL, origen VARCHAR(4) NOT NULL, pbr TINYINT DEFAULT 0, hta TINYINT DEFAULT 0, obesidad TINYINT DEFAULT 0, dislipemia TINYINT DEFAULT 0, tabaquismo TINYINT DEFAULT 0, iam TINYINT DEFAULT 0, ave TINYINT DEFAULT 0, revasc_cardio TINYINT DEFAULT 0, INDEX paciente_id_idx (paciente_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE pacientes (id INT AUTO_INCREMENT, the INT NOT NULL, ci VARCHAR(12) NOT NULL, nombre VARCHAR(50) NOT NULL, apellido VARCHAR(50) NOT NULL, num_fnr MEDIUMINT NOT NULL, raza VARCHAR(15) NOT NULL, sexo VARCHAR(1) NOT NULL, fecha_nacimiento DATE NOT NULL, fecha_dialisis DATE NOT NULL, nefropatia_id INT NOT NULL, grupo_sanguineo VARCHAR(2) NOT NULL, INDEX nefropatia_id_idx (nefropatia_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE trasplante (id INT AUTO_INCREMENT, pretrasplante INT, fecha DATE, num_tr INT, id_donante VARCHAR(20), inestab_hemod TINYINT, rinhon VARCHAR(10), anomalia_vasc TINYINT, num_art TINYINT, num_venas TINYINT, ureter VARCHAR(5), num_comp_a_b MEDIUMINT, num_comp_dr MEDIUMINT, num_imcomp_a_b MEDIUMINT, num_imcomp_dr MEDIUMINT, autoac TINYINT, pra_max VARCHAR(10), pra_tr VARCHAR(20), trans_previas TINYINT, num_transf TINYINT, embarazo VARCHAR(9), num_embarazo TINYINT, liq_perfusion VARCHAR(11), tq_de_banco TINYINT, lado_implante VARCHAR(10), anast_venosa VARCHAR(17), anast_arterial VARCHAR(17), anast_ureteral VARCHAR(9), t_isq_cal_min MEDIUMINT, t_isq_fria_hs MEDIUMINT, t_isq_fria_min MEDIUMINT, t_isq_tibia_hs MEDIUMINT, repercusion VARCHAR(7), sangrado_i_op TINYINT, lesion_arterial TINYINT, lesion_venosa TINYINT, necesidad_repefundir TINYINT, otras_compl_quirur VARCHAR(250), diuresis_i_op TINYINT, cr_inicial FLOAT(18, 2), dia_rec_diuresis SMALLINT, dia_rec_funcional SMALLINT, dialisis TINYINT, num_de_hd SMALLINT, comentario VARCHAR(255), fecha_alta DATE, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_content (id INT AUTO_INCREMENT, md_user_id INT NOT NULL, object_class VARCHAR(128) NOT NULL, object_id INT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX md_user_id_idx (md_user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_content_relation (md_content_id_first INT, md_content_id_second INT, object_class_name VARCHAR(128) NOT NULL, profile_name VARCHAR(128), PRIMARY KEY(md_content_id_first, md_content_id_second)) ENGINE = INNODB;
CREATE TABLE md_media (id INT AUTO_INCREMENT, object_class_name VARCHAR(128) NOT NULL, object_id INT NOT NULL, UNIQUE INDEX md_media_index_idx (object_class_name, object_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_media_album (id INT AUTO_INCREMENT, md_media_id INT, title VARCHAR(64) NOT NULL, description VARCHAR(255), type VARCHAR(255) DEFAULT 'Mixed', deleteallowed bool NOT NULL, md_media_content_id INT, counter_content BIGINT DEFAULT 0, UNIQUE INDEX md_media_album_title_index_idx (md_media_id, title), INDEX md_media_content_id_idx (md_media_content_id), INDEX md_media_id_idx (md_media_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_media_album_content (md_media_album_id INT, md_media_content_id INT, object_class_name VARCHAR(128) NOT NULL, priority BIGINT NOT NULL, INDEX md_media_album_content_index_idx (priority ASC), PRIMARY KEY(md_media_album_id, md_media_content_id)) ENGINE = INNODB;
CREATE TABLE md_media_content (id INT AUTO_INCREMENT, object_class_name VARCHAR(128) NOT NULL, object_id INT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, UNIQUE INDEX md_media_content_index_idx (object_class_name, object_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_media_file (id INT AUTO_INCREMENT, name VARCHAR(64) NOT NULL, filename VARCHAR(64) NOT NULL, filetype VARCHAR(64) NOT NULL, description VARCHAR(255), path VARCHAR(255), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_media_image (id INT AUTO_INCREMENT, name VARCHAR(64) NOT NULL, filename VARCHAR(64) NOT NULL, description VARCHAR(255), path VARCHAR(255), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_media_video (id INT AUTO_INCREMENT, name VARCHAR(64) NOT NULL, filename VARCHAR(64) NOT NULL, duration VARCHAR(64) NOT NULL, type VARCHAR(64) NOT NULL, description VARCHAR(255), path VARCHAR(255), avatar VARCHAR(255), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_media_you_tube_video (id INT AUTO_INCREMENT, name VARCHAR(64) NOT NULL, src VARCHAR(255) NOT NULL, code VARCHAR(64) NOT NULL, duration VARCHAR(64) NOT NULL, description VARCHAR(255), path VARCHAR(255), avatar VARCHAR(255), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_passport (id INT AUTO_INCREMENT, md_user_id INT NOT NULL, username VARCHAR(128) NOT NULL, password VARCHAR(128) NOT NULL, account_active TINYINT DEFAULT '0' NOT NULL, last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX md_user_id_idx (md_user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_passport_remember_key (id INT AUTO_INCREMENT, md_passport_id INT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX md_passport_id_idx (md_passport_id), PRIMARY KEY(id, ip_address)) ENGINE = INNODB;
CREATE TABLE md_user (id INT AUTO_INCREMENT, email VARCHAR(128) NOT NULL UNIQUE, super_admin TINYINT DEFAULT '0' NOT NULL, deleted_at DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE md_user_profile (id INT AUTO_INCREMENT, name VARCHAR(128), last_name VARCHAR(128), city VARCHAR(128), country_code VARCHAR(2) DEFAULT 'UY', PRIMARY KEY(id)) ENGINE = INNODB;
ALTER TABLE cmv ADD CONSTRAINT cmv_trasplante_id_trasplante_id FOREIGN KEY (trasplante_id) REFERENCES trasplante(id) ON DELETE CASCADE;
ALTER TABLE cmv ADD CONSTRAINT cmv_cmv_droga_id_cmvdrogas_id FOREIGN KEY (cmv_droga_id) REFERENCES cmvdrogas(id);
ALTER TABLE cmv ADD CONSTRAINT cmv_cmv_diagnostico_id_cmvdiagnostico_id FOREIGN KEY (cmv_diagnostico_id) REFERENCES cmvdiagnostico(id);
ALTER TABLE cmv_uso_enfermedades ADD CONSTRAINT cmv_uso_enfermedades_cmv_id_cmv_id FOREIGN KEY (cmv_id) REFERENCES cmv(id) ON DELETE CASCADE;
ALTER TABLE cmv_uso_enfermedades ADD CONSTRAINT cmv_uso_enfermedades_cmv_emfermedades_id_cmvemfermedades_id FOREIGN KEY (cmv_emfermedades_id) REFERENCES cmvemfermedades(id) ON DELETE CASCADE;
ALTER TABLE paciente_muerte ADD CONSTRAINT paciente_muerte_causa_muerte_id_paciente_causa_muerte_id FOREIGN KEY (causa_muerte_id) REFERENCES paciente_causa_muerte(id);
ALTER TABLE paciente_pre_trasplante ADD CONSTRAINT paciente_pre_trasplante_paciente_id_pacientes_id FOREIGN KEY (paciente_id) REFERENCES pacientes(id) ON DELETE CASCADE;
ALTER TABLE pacientes ADD CONSTRAINT pacientes_nefropatia_id_nefropatia_id FOREIGN KEY (nefropatia_id) REFERENCES nefropatia(id) ON DELETE CASCADE;
ALTER TABLE md_content ADD CONSTRAINT md_content_md_user_id_md_user_id FOREIGN KEY (md_user_id) REFERENCES md_user(id);
ALTER TABLE md_content_relation ADD CONSTRAINT md_content_relation_md_content_id_second_md_content_id FOREIGN KEY (md_content_id_second) REFERENCES md_content(id);
ALTER TABLE md_content_relation ADD CONSTRAINT md_content_relation_md_content_id_first_md_content_id FOREIGN KEY (md_content_id_first) REFERENCES md_content(id);
ALTER TABLE md_media_album ADD CONSTRAINT md_media_album_md_media_id_md_media_id FOREIGN KEY (md_media_id) REFERENCES md_media(id);
ALTER TABLE md_media_album ADD CONSTRAINT md_media_album_md_media_content_id_md_media_content_id FOREIGN KEY (md_media_content_id) REFERENCES md_media_content(id);
ALTER TABLE md_media_album_content ADD CONSTRAINT md_media_album_content_md_media_content_id_md_media_content_id FOREIGN KEY (md_media_content_id) REFERENCES md_media_content(id);
ALTER TABLE md_media_album_content ADD CONSTRAINT md_media_album_content_md_media_album_id_md_media_album_id FOREIGN KEY (md_media_album_id) REFERENCES md_media_album(id);
ALTER TABLE md_passport ADD CONSTRAINT md_passport_md_user_id_md_user_id FOREIGN KEY (md_user_id) REFERENCES md_user(id);
ALTER TABLE md_passport_remember_key ADD CONSTRAINT md_passport_remember_key_md_passport_id_md_passport_id FOREIGN KEY (md_passport_id) REFERENCES md_passport(id) ON DELETE CASCADE;
